<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Absensi TQS-KHS 2025/2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4895ef;
            --dark: #1b263b;
            --light: #f8f9fa;
            --success: #4cc9f0;
            --warning: #f72585;
            --gray: #adb5bd;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .card-title {
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        select, input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: border 0.3s ease;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: var(--primary);
            color: white;
            font-weight: 500;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tr:hover {
            background-color: #f1f3ff;
        }
        
        .status-select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-family: 'Poppins', sans-serif;
        }
        
        .present {
            background-color: #e6f7ee;
            color: #28a745;
        }
        
        .absent {
            background-color: #fdecea;
            color: #dc3545;
        }
        
        .sick {
            background-color: #fff8e6;
            color: #ffc107;
        }
        
        .permit {
            background-color: #e6f3ff;
            color: #17a2b8;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .time-badge {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-left: 10px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            header h1 {
                font-size: 1.8rem;
            }
            
            .card {
                padding: 15px;
            }
            
            th, td {
                padding: 10px;
                font-size: 0.9rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SISTEM ABSENSI KELAS TQS-KHS</h1>
            <p>Tahun Akademik 2025/2026</p>
        </header>
        
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Informasi Pertemuan</h2>
                <div id="current-date-time"></div>
            </div>
            
            <div class="form-group">
                <label for="pertemuan">Pertemuan Ke:</label>
                <select id="pertemuan">
                    <option value="1">Pertemuan 1</option>
                    <option value="2">Pertemuan 2</option>
                    <option value="3">Pertemuan 3</option>
                    <option value="4">Pertemuan 4</option>
                    <option value="5">Pertemuan 5</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="waktu">Waktu Pertemuan:</label>
                <select id="waktu">
                    <option value="06:15-07:00">06:15-07:00</option>
                    <option value="08:45-09:30">08:45-09:30</option>
                    <option value="10:00-10:45">10:00-10:45</option>
                    <option value="10:45-11:30">10:45-11:30</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="topik">Topik Pembahasan:</label>
                <input type="text" id="topik" placeholder="Masukkan topik pembahasan">
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="tqs">Kelas TQS Angkatan 05</div>
            <div class="tab" data-tab="khs">Kelas KHS Angkatan 01</div>
        </div>
        
        <div class="tab-content active" id="tqs-content">
            <div class="card">
                <h2 class="card-title">Daftar Mahasiswa TQS Angkatan 05</h2>
                <table id="tqs-table">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Nama Mahasiswa</th>
                            <th>Status</th>
                            <th>Keterangan</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data akan diisi oleh JavaScript -->
                    </tbody>
                </table>
                
                <div class="btn-group">
                    <button id="save-tqs" class="btn">Simpan Absensi TQS</button>
                    <button id="reset-tqs" class="btn btn-outline">Reset</button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="khs-content">
            <div class="card">
                <h2 class="card-title">Daftar Mahasiswa KHS Angkatan 01</h2>
                <table id="khs-table">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Nama Mahasiswa</th>
                            <th>Status</th>
                            <th>Keterangan</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Data akan diisi oleh JavaScript -->
                    </tbody>
                </table>
                
                <div class="btn-group">
                    <button id="save-khs" class="btn">Simpan Absensi KHS</button>
                    <button id="reset-khs" class="btn btn-outline">Reset</button>
                </div>
            </div>
        </div>
        
        <footer>
            &copy; 2025 Sistem Absensi TQS-KHS | Dibangun dengan ❤️ untuk Pendidikan
        </footer>
    </div>

    <script>
        // Data Mahasiswa
        const students = {
            tqs: [
                "FUAD FIRDAUS",
                "FAUZAN TAUFIQ",
                "JABIR",
                "AFFAN AL FARINSY",
                "AL HARITS",
                "AZMI AT TAMANI",
                "MUHAMMAD ZUBAIR",
                "JUNDI ABDULLAH",
                "ABDUL HADI",
                "YAHYA BJR",
                "SUFYAN BIN AFIT",
                "FAZA UBAIDILLAH",
                "MUHAMMAD"
            ],
            khs: [
                "ABDULLAH SERIWA",
                "YODA AFRIZAL",
                "DAWUD",
                "ADAM ROFIF TSAQIF",
                "MUHAMMAD SURYA BASKARAJATI",
                "FARID",
                "MUHAMMAD FAQQIH MUBAROK",
                "YAHYA KRW",
                "HAMMAAM",
                "MUHAMMAD DZAKY MUMTAZ",
                "UMAIR",
                "DIMAS EKA NUGRAHA",
                "MUHAMAD DENI MAULANA"
            ]
        };

        // Inisialisasi
        document.addEventListener('DOMContentLoaded', function() {
            // Update tanggal dan waktu
            function updateDateTime() {
                const now = new Date();
                const options = { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                };
                document.getElementById('current-date-time').textContent = 
                    now.toLocaleDateString('id-ID', options);
            }
            
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // Isi tabel mahasiswa
            fillStudentTable('tqs');
            fillStudentTable('khs');
            
            // Tab functionality
            setupTabs();
            
            // Button events
            document.getElementById('save-tqs').addEventListener('click', () => saveAttendance('tqs'));
            document.getElementById('save-khs').addEventListener('click', () => saveAttendance('khs'));
            document.getElementById('reset-tqs').addEventListener('click', () => resetForm('tqs'));
            document.getElementById('reset-khs').addEventListener('click', () => resetForm('khs'));
        });
        
        function fillStudentTable(kelas) {
            const tableBody = document.querySelector(`#${kelas}-table tbody`);
            tableBody.innerHTML = '';
            
            students[kelas].forEach((student, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${student}</td>
                    <td>
                        <select class="status-select" data-name="${student}">
                            <option value="present">Hadir</option>
                            <option value="absent">Tidak Hadir</option>
                            <option value="sick">Sakit</option>
                            <option value="permit">Izin</option>
                        </select>
                    </td>
                    <td><input type="text" class="note" data-name="${student}" placeholder="Keterangan"></td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs and contents
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding content
                    tab.classList.add('active');
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-content`).classList.add('active');
                });
            });
        }
        
        function saveAttendance(kelas) {
            const pertemuan = document.getElementById('pertemuan').value;
            const waktu = document.getElementById('waktu').value;
            const topik = document.getElementById('topik').value;
            const date = new Date().toISOString().split('T')[0];
            
            const attendanceData = [];
            const rows = document.querySelectorAll(`#${kelas}-table tbody tr`);
            
            rows.forEach(row => {
                const name = row.querySelector('.status-select').getAttribute('data-name');
                const status = row.querySelector('.status-select').value;
                const note = row.querySelector('.note').value;
                
                attendanceData.push({
                    kelas: kelas.toUpperCase(),
                    nama: name,
                    pertemuan,
                    tanggal: date,
                    waktu,
                    topik,
                    status,
                    keterangan: note
                });
            });
            
            // Kirim data ke Google Sheets
            sendToGoogleSheets(attendanceData, kelas);
        }
        
        function resetForm(kelas) {
            const selects = document.querySelectorAll(`#${kelas}-table .status-select`);
            const notes = document.querySelectorAll(`#${kelas}-table .note`);
            
            selects.forEach(select => {
                select.value = 'present';
            });
            
            notes.forEach(note => {
                note.value = '';
            });
            
            Swal.fire({
                icon: 'success',
                title: 'Form direset',
                text: `Data absensi ${kelas.toUpperCase()} telah direset ke default`,
                timer: 1500,
                showConfirmButton: false
            });
        }
        
        function sendToGoogleSheets(data, kelas) {
            // Ganti dengan URL Apps Script Anda
            const scriptUrl = 'https://script.google.com/macros/s/https://script.google.com/macros/s/AKfycbxOloC4j2OCYe6Ph-M-868lawuchex5MNG8Y-heJNylFboclpksAxmHB7sSL4C5SJNFeQ/exec';
            
            fetch(scriptUrl, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(() => {
                Swal.fire({
                    icon: 'success',
                    title: 'Berhasil!',
                    text: `Absensi ${kelas.toUpperCase()} berhasil disimpan di Google Sheets`,
                    confirmButtonText: 'OK'
                });
            })
            .catch(error => {
                Swal.fire({
                    icon: 'error',
                    title: 'Gagal',
                    text: 'Terjadi kesalahan saat menyimpan data: ' + error,
                    confirmButtonText: 'OK'
                });
            });
        }
    </script>
</body>
</html>
